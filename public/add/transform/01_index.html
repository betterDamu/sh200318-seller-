<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        #app{
            width: 100px;
            height: 100px;
            background: pink;
            transition: 3s transform linear;
        }
    </style>
</head>
<body>
    <button id="btn">位移</button>
    <button id="btn2">旋转</button>
    <button id="btn3">读值</button>
    <div id="app"></div>
</body>
<script>
    window.onload=function () {
        var appNode = document.querySelector("#app");
        var btnNode = document.querySelector("#btn");
        var btnNode2 = document.querySelector("#btn2");
        var btnNode3 = document.querySelector("#btn3");
        btnNode.onclick=function () {
            /* 变换存储的数据结构
                appNode.transform :{
                    translateX:400
                }
            */
            // appNode.style.transform = "translateX(400px)";
            transform(appNode,"translateX",400);
            /* 变换存储的数据结构
               appNode.transform :{
                   translateX:400,
                   rotate:0
               }
           */
            //appNode.style.transform = "translateX(400px) rotate(0deg)";
            transform(appNode,"rotate",0)
        }
        btnNode2.onclick=function () {
            // appNode.style.transform = "translateX(400px) rotate(720deg)";
            transform(appNode,"rotate",720)
        }
        btnNode3.onclick=function () {
            console.log(transform(appNode,"scale"))
        }
    }


    /*定义一个transform函数用来管理一个元素的transform变换
        transform(node,type,val) 代表是给指定节点指定的变换去设置值
        transform(node,type)     代表是获取指定节点指定的变换当前的值*/



    function transform(node,type,val) {
        //扩展了dom的api 给元素节点加了一个transform属性 用来存储当前节点所有的变换的类型及其值
        if(!node.transform){node.transform={}}
        //node身上百分百有了transform属性

        if(arguments.length === 3){
            //设置
            var text = "";
            node.transform[type] = val;

            for(var name in node.transform){
                switch (name){
                    case "translateX":
                    case "translateY":
                    case "translateZ":
                        text+=name+"("+node.transform[name]+"px) "
                        break;
                    case "rotateX":
                    case "rotateY":
                    case "rotate":
                        text+=name+"("+node.transform[name]+"deg) "
                        break;
                    case "scaleX":
                    case "scaleY":
                    case "scale":
                        text+=name+"("+node.transform[name]+") "
                        break;
                }
            }

            node.style.transform = node.style.webkitTransform = text;
        }else if(arguments.length === 2){
            //读取
            val = node.transform[type]
            if(val === undefined){
                //返回默认值
                switch (type){
                    case "translateX":
                    case "translateY":
                    case "translateZ":
                    case "rotateX":
                    case "rotateY":
                    case "rotate":
                        val = 0;
                        break;
                    case "scaleX":
                    case "scaleY":
                    case "scale":
                        val = 1;
                        break;
                }
            }
            return val
        }
    }
</script>
</html>